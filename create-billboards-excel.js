const XLSX = require("xlsx")
const fs = require("fs")
const path = require("path")

// بيانات اللوحات الإعلانية
const billboardsData = [
  {
    "ر.م": "132",
    "اسم لوحة": "KH-SK0132",
    "اقرب نقطة دالة": "الجزيرة الجديدة مدخل شارع 20",
    البلدية: "الخمس",
    مدينة: "الخمس",
    حجم: "12X4",
    مستوى: "B",
    الحالة: "متاح",
    "احداثي - GPS": "32.639466,14.265113",
    image_url: "https://lh3.googleusercontent.com/d/1IXWjRnWIqrRnsCIR1UEdsrWqqNeDW8eL",
    "رقم العقد": "",
  },
  {
    "ر.م": "943",
    "اسم لوحة": "TR-TG0943",
    "اقرب نقطة دالة": "امام كلية الهندسة العسكرية باتجاه الشرق",
    البلدية: "تاجوراء",
    مدينة: "طرابلس",
    حجم: "12X4",
    مستوى: "A",
    الحالة: "متاح",
    "احداثي - GPS": "32.77941062678118,13.202820303855821",
    image_url: "https://lh3.googleusercontent.com/d/1y3u807ziWfFgaYpsUlA3Rufmu7vyzY7u",
    "رقم العقد": "",
  },
  {
    "ر.م": "134",
    "اسم لوحة": "KH-SK0134",
    "اقرب نقطة دالة": "بجوار كوبري سوق الخميس باتجاه الشرق",
    البلدية: "الخمس",
    مدينة: "الخمس",
    حجم: "12X4",
    مستوى: "B",
    الحالة: "متاح",
    "احداثي - GPS": "32.566533,14.344944",
    image_url: "https://lh3.googleusercontent.com/d/1J1D2ZEhnQZbRuSKxNVE4XTifkhvHabYs",
    "رقم العقد": "",
  },
  {
    "ر.م": "917",
    "اسم لوحة": "TR-JZ0917",
    "اقرب نقطة دالة": "بعد مخرج السراج بـ800 متر",
    البلدية: "جنزور",
    مدينة: "طرابلس",
    حجم: "12x4",
    مستوى: "A",
    الحالة: "متاح",
    "احداثي - GPS": "32.838179,13.071658",
    image_url: "/roadside-billboard.png",
    "رقم العقد": "",
  },
  {
    "ر.م": "130",
    "اسم لوحة": "KH-SK0130",
    "اقرب نقطة دالة": "بجوار جسر سوق الخميس باتجاه الغرب",
    البلدية: "الخمس",
    مدينة: "الخمس",
    حجم: "12X4",
    مستوى: "B",
    الحالة: "متاح",
    "احداثي - GPS": "32.566533,14.344944",
    image_url: "https://lh3.googleusercontent.com/d/1iHHF-cuvAvgs0-gpW65zkxFrLU2qV7bE",
    "رقم العقد": "",
  },
  {
    "ر.م": "140",
    "اسم لوحة": "ZL-ZL0140",
    "اقرب نقطة دالة": "مدخل المدينة الغربي بجوار كمرة كعام باتجاه الشرق",
    البلدية: "زليتن",
    مدينة: "زليتن",
    حجم: "12X4",
    مستوى: "B",
    الحالة: "متاح",
    "احداثي - GPS": "32.498982,14.446801",
    image_url: "https://lh3.googleusercontent.com/d/1_js8MPBTvM_ymwPNm1oedZfjtDuMPIfj",
    "رقم العقد": "",
  },
  {
    "ر.م": "145",
    "اسم لوحة": "MS-MS0145",
    "اقرب نقطة دالة": "مدخل مصراتة الشرقي بجوار محطة الوقود",
    البلدية: "مصراتة",
    مدينة: "مصراتة",
    حجم: "12X4",
    مستوى: "A",
    الحالة: "متاح",
    "احداثي - GPS": "32.374166,15.087778",
    image_url: "/roadside-billboard.png",
    "رقم العقد": "",
  },
  {
    "ر.م": "150",
    "اسم لوحة": "BN-BN0150",
    "اقرب نقطة دالة": "مدخل بني وليد الشمالي",
    البلدية: "بني وليد",
    مدينة: "بني وليد",
    حجم: "12X4",
    مستوى: "B",
    الحالة: "متاح",
    "احداثي - GPS": "31.755833,13.982222",
    image_url: "/roadside-billboard.png",
    "رقم العقد": "",
  },
  {
    "ر.م": "155",
    "اسم لوحة": "SB-SB0155",
    "اقرب نقطة دالة": "مدخل سبها الشرقي بجوار الجامعة",
    البلدية: "سبها",
    مدينة: "سبها",
    حجم: "12X4",
    مستوى: "A",
    الحالة: "متاح",
    "احداثي - GPS": "27.037778,14.428889",
    image_url: "/roadside-billboard.png",
    "رقم العقد": "",
  },
  {
    "ر.م": "160",
    "اسم لوحة": "BG-BG0160",
    "اقرب نقطة دالة": "مدخل بنغازي الغربي بجوار المطار",
    البلدية: "بنغازي",
    مدينة: "بنغازي",
    حجم: "12X4",
    مستوى: "A",
    الحالة: "متاح",
    "احداثي - GPS": "32.116667,20.068056",
    image_url: "/roadside-billboard.png",
    "رقم العقد": "",
  },
]

// إنشاء ورقة عمل جديدة
const worksheet = XLSX.utils.json_to_sheet(billboardsData)

// إنشاء مصنف جديد
const workbook = XLSX.utils.book_new()
XLSX.utils.book_append_sheet(workbook, worksheet, "اللوحات الإعلانية")

// التأكد من وجود مجلد public
const publicDir = path.join(process.cwd(), "public")
if (!fs.existsSync(publicDir)) {
  fs.mkdirSync(publicDir, { recursive: true })
}

// حفظ الملف
const filePath = path.join(publicDir, "billboards.xlsx")
XLSX.writeFile(workbook, filePath)

console.log("[v0] تم إنشاء ملف الإكسل بنجاح في:", filePath)
console.log("[v0] عدد اللوحات المحفوظة:", billboardsData.length)
